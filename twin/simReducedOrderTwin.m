function [ eta_dot, xi ] =  simReducedOrderTwin( t, eta, k, M,    ...
                                                 m1, m2, l1, l2,  ...
                                                 g, k_tanh,       ...
                                                 b_p1_c, b_p1_v,  ...
                                                 b_p2_c, b_p2_v   )
                                          
  eta1 = eta(1);
  eta2 = eta(2);
  eta3 = eta(3);
  eta4 = eta(4);
  eta5 = eta(5);
  
  xi   = -k*eta;

  eta_dot =                                                          ...
                                                                     ...
[ (eta4*l1 + l1*xi*cos(eta1) - l2*xi*cos(eta1)                       ...
   + eta3*l1*l2)/(l1*(l1 - l2))                                        ;
 -(eta4*l2 - l1*xi*cos(eta2) + l2*xi*cos(eta2)                       ...
   + eta3*l1*l2)/(l2*(l1 - l2))                                        ;
  (b_p1_c*l1^2*l2^3*m2*tanh((k_tanh*(eta4*l1 + l1*xi*cos(eta1)       ...
   - l2*xi*cos(eta1) + eta3*l1*l2))/(l1*(l1 - l2)))                  ...
   + b_p2_c*l1^3*l2^2*m1*tanh((k_tanh*(eta4*l2 - l1*xi*cos(eta2)     ...
   + l2*xi*cos(eta2) + eta3*l1*l2))/(l2*(l1 - l2)))                  ...
   - b_p1_v*l2^4*m2*xi*cos(eta1) + b_p2_v*l1^4*m1*xi*cos(eta2)       ...
   - b_p1_c*l1*l2^4*m2*tanh((k_tanh*(eta4*l1 + l1*xi*cos(eta1)       ...
   - l2*xi*cos(eta1) + eta3*l1*l2))/(l1*(l1 - l2)))                  ...
   - b_p2_c*l1^4*l2*m1*tanh((k_tanh*(eta4*l2 - l1*xi*cos(eta2)       ...
   + l2*xi*cos(eta2) + eta3*l1*l2))/(l2*(l1 - l2)))                  ...
   + b_p1_v*eta3*l1*l2^4*m2 + b_p1_v*eta4*l1*l2^3*m2                 ...
   - b_p2_v*eta3*l1^4*l2*m1 - b_p2_v*eta4*l1^3*l2*m1                 ...
   + g*l1^2*l2^4*m1*m2*sin(eta1) - g*l1^3*l2^3*m1*m2*sin(eta1)       ...
   + g*l1^3*l2^3*m1*m2*sin(eta2) - g*l1^4*l2^2*m1*m2*sin(eta2)       ...
   + (l1*l2^4*m1*m2*xi^2*sin(2*eta1))/2                              ...
   - (l1^4*l2*m1*m2*xi^2*sin(2*eta2))/2                              ...
   + b_p1_v*l1*l2^3*m2*xi*cos(eta1) - b_p2_v*l1^3*l2*m1*xi*cos(eta2) ...
   - (l1^2*l2^3*m1*m2*xi^2*sin(2*eta1))/2                            ...
   + (l1^3*l2^2*m1*m2*xi^2*sin(2*eta2))/2                            ...
   - eta3*l1^2*l2^4*m1*m2*xi*sin(eta1)                               ...
   - eta4*l1^2*l2^3*m1*m2*xi*sin(eta1)                               ...
   + eta3*l1^4*l2^2*m1*m2*xi*sin(eta2)                               ...
   + eta4*l1^3*l2^2*m1*m2*xi*sin(eta2))/(l1^3*l2^3*m1*m2*(l1 - l2))    ;
 -(b_p1_c*l1^2*l2^2*m2*tanh((k_tanh*(eta4*l1 + l1*xi*cos(eta1)       ...
   - l2*xi*cos(eta1) + eta3*l1*l2))/(l1*(l1 - l2)))                  ...
   + b_p2_c*l1^2*l2^2*m1*tanh((k_tanh*(eta4*l2 - l1*xi*cos(eta2)     ...
   + l2*xi*cos(eta2) + eta3*l1*l2))/(l2*(l1 - l2)))                  ...
   - b_p1_v*l2^3*m2*xi*cos(eta1) + b_p2_v*l1^3*m1*xi*cos(eta2)       ...
   - b_p1_c*l1*l2^3*m2*tanh((k_tanh*(eta4*l1 + l1*xi*cos(eta1)       ...
   - l2*xi*cos(eta1) + eta3*l1*l2))/(l1*(l1 - l2)))                  ...
   - b_p2_c*l1^3*l2*m1*tanh((k_tanh*(eta4*l2 - l1*xi*cos(eta2)       ...
   + l2*xi*cos(eta2) + eta3*l1*l2))/(l2*(l1 - l2)))                  ...
   + b_p1_v*eta3*l1*l2^3*m2 + b_p1_v*eta4*l1*l2^2*m2                 ...
   - b_p2_v*eta3*l1^3*l2*m1 - b_p2_v*eta4*l1^2*l2*m1                 ...
   + g*l1^2*l2^3*m1*m2*sin(eta1) - g*l1^3*l2^2*m1*m2*sin(eta1)       ...
   + g*l1^2*l2^3*m1*m2*sin(eta2) - g*l1^3*l2^2*m1*m2*sin(eta2)       ...
   + (l1*l2^3*m1*m2*xi^2*sin(2*eta1))/2                              ...
   - (l1^3*l2*m1*m2*xi^2*sin(2*eta2))/2                              ...
   + b_p1_v*l1*l2^2*m2*xi*cos(eta1)                                  ...
   - b_p2_v*l1^2*l2*m1*xi*cos(eta2)                                  ...
   - (l1^2*l2^2*m1*m2*xi^2*sin(2*eta1))/2                            ...
   + (l1^2*l2^2*m1*m2*xi^2*sin(2*eta2))/2                            ...
   - eta3*l1^2*l2^3*m1*m2*xi*sin(eta1)                               ...
   - eta4*l1^2*l2^2*m1*m2*xi*sin(eta1)                               ...
   + eta3*l1^3*l2^2*m1*m2*xi*sin(eta2)                               ...
   + eta4*l1^2*l2^2*m1*m2*xi*sin(eta2))/(l1^2*l2^2*m1*m2*(l1 - l2))  ;
  xi                                                                ];
 

  